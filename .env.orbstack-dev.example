# ==============================================================================
# LOCAL DEVELOPMENT (macOS + OrbStack)
# ==============================================================================
# Use this configuration when:
# - Developing on macOS with OrbStack installed
# - Running Next.js with `pnpm dev` on your host machine
# - Backend services (PostgreSQL, Keycloak, MinIO) running in Docker
# - Accessing services via OrbStack domains (*.orb.local)
#
# Setup:
#   1. Start backend services: docker compose up -d postgres keycloak minio
#   2. Copy this file: cp .env.orbstack-dev.example .env.local
#   3. Start dev server: pnpm dev
#   4. Access app at: http://localhost:3000
# ==============================================================================

# Database Configuration
# Use OrbStack domain with exposed port from host machine
DATABASE_URL=postgresql://kwiki:kwiki123@postgres.k-wiki.orb.local:5432/k_wiki

# MinIO Configuration
MINIO_PORT=9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin123
MINIO_BUCKET_NAME=k-wiki
MINIO_USE_SSL=false

# Keycloak Configuration
# IMPORTANT: Use HTTP (not HTTPS) to avoid Node.js rejecting self-signed certs
# The browser can use HTTPS (https://keycloak.k-wiki.orb.local) but server-side
# Next.js code should use HTTP for the ISSUER URL
KEYCLOAK_CLIENT_ID=k-wiki-client
KEYCLOAK_CLIENT_SECRET=your-client-secret-from-keycloak-admin-console
KEYCLOAK_ISSUER=http://keycloak.k-wiki.orb.local/realms/k-wiki

# NextAuth Configuration
# Next.js runs on host machine port 3000
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=generate-with-openssl-rand-base64-32

# ==============================================================================
# NOTES:
#
# 1. Keycloak Admin Console: https://keycloak.k-wiki.orb.local (browser)
# 2. MinIO Console: https://minio.k-wiki.orb.local:9001
# 3. PostgreSQL: postgres.k-wiki.orb.local:5432
#
# 4. Keycloak Client Setup:
#    - Go to: https://keycloak.k-wiki.orb.local
#    - Login with KEYCLOAK_ADMIN credentials
#    - Create realm: k-wiki
#    - Create client: k-wiki-client
#      - Client Protocol: openid-connect
#      - Access Type: confidential
#      - Valid Redirect URIs: http://localhost:3000/api/auth/callback/keycloak
#      - Web Origins: http://localhost:3000
#    - Copy Client Secret to KEYCLOAK_CLIENT_SECRET above
#
# 5. Generate NEXTAUTH_SECRET:
#    Run: openssl rand -base64 32
#
# 6. Why HTTP for KEYCLOAK_ISSUER?
#    OrbStack uses self-signed certificates. Node.js fetch() rejects these by
#    default. Using HTTP avoids cert validation issues in development.
# ==============================================================================
