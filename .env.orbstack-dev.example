# ==============================================================================
# LOCAL DEVELOPMENT (macOS + OrbStack)
# ==============================================================================
# Use this configuration when:
# - Developing on macOS with OrbStack installed
# - Running Next.js with `pnpm dev` on your host machine
# - Backend services (PostgreSQL, Keycloak, MinIO) running in Docker
# - Accessing services via OrbStack domains (*.orb.local)
#
# Setup:
#   1. Start backend services: docker compose up -d postgres keycloak minio
#   2. Copy this file: cp .env.orbstack-dev.example .env.local
#   3. Start dev server: pnpm dev
#   4. Access app at: http://localhost:3000
# ==============================================================================

# ==============================================================================
# PostgreSQL Configuration
# ==============================================================================
POSTGRES_USER=kwiki
POSTGRES_PASSWORD=kwiki123
POSTGRES_APP_DB=k_wiki
POSTGRES_APP_USER=kwiki
POSTGRES_APP_PASSWORD=kwiki123

# Database URL for Prisma (use OrbStack domain with exposed port)
DATABASE_URL=postgresql://kwiki:kwiki123@postgres.k-wiki.orb.local:5432/k_wiki

# ==============================================================================
# Keycloak Configuration
# ==============================================================================
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=admin123
KEYCLOAK_REALM=k-wiki
KEYCLOAK_CLIENT_ID=k-wiki-client
KEYCLOAK_CLIENT_SECRET=your-client-secret-from-keycloak-admin-console

# Keycloak Issuer URL (for NextAuth.js)
# IMPORTANT: Use HTTPS for OrbStack domains, but set NODE_TLS_REJECT_UNAUTHORIZED=0
# to accept self-signed certificates in development
KEYCLOAK_ISSUER=https://keycloak.k-wiki.orb.local/realms/k-wiki

# Keycloak Admin API URL (for user management)
KEYCLOAK_ADMIN_URL=https://keycloak.k-wiki.orb.local

# ==============================================================================
# MinIO Configuration
# ==============================================================================
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin123
MINIO_BUCKET_NAME=k-wiki

# MinIO endpoint for internal client connections
MINIO_ENDPOINT=minio.k-wiki.orb.local
MINIO_PORT=9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin123
MINIO_USE_SSL=false

# MinIO public URL for generating accessible URLs via Nginx proxy
MINIO_PUBLIC_URL=https://nginx.k-wiki.orb.local/storage

# ==============================================================================
# NextAuth Configuration
# ==============================================================================
# Next.js runs on host machine port 3000
NEXTAUTH_URL=https://nginx.k-wiki.orb.local0
NEXTAUTH_SECRET=generate-with-openssl-rand-base64-32

# ==============================================================================
# Node.js Configuration
# ==============================================================================
# Accept self-signed certificates from OrbStack in development
NODE_TLS_REJECT_UNAUTHORIZED=0

# ==============================================================================
# NOTES:
#
# 1. Access Points:
#    - App: http://localhost:3000
#    - Keycloak Admin Console: https://keycloak.k-wiki.orb.local
#    - MinIO Console: https://minio.k-wiki.orb.local:9001
#    - PostgreSQL: postgres.k-wiki.orb.local:5432
#
# 2. Keycloak Client Setup:
#    - Go to: https://keycloak.k-wiki.orb.local
#    - Login with KEYCLOAK_ADMIN credentials
#    - Create realm: k-wiki
#    - Create client: k-wiki-client
#      - Client Protocol: openid-connect
#      - Access Type: confidential
#      - Valid Redirect URIs: http://localhost:3000/api/auth/callback/keycloak
#      - Web Origins: http://localhost:3000
#    - Copy Client Secret to KEYCLOAK_CLIENT_SECRET above
#
# 3. Generate NEXTAUTH_SECRET:
#    Run: openssl rand -base64 32
#
# 4. Why NODE_TLS_REJECT_UNAUTHORIZED=0?
#    OrbStack uses self-signed certificates for HTTPS. Node.js fetch() rejects
#    these by default. This setting allows Next.js to connect to Keycloak in
#    development. Never use in production!
#
# 5. OrbStack Benefits:
#    - Automatic domain names (*.orb.local) for all containers
#    - Built-in HTTPS support with self-signed certificates
#    - Better macOS integration and performance than Docker Desktop
# ==============================================================================
