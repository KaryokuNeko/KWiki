# ==============================================================================
# STANDARD DOCKER DEPLOYMENT (WITH CUSTOM DOMAIN)
# ==============================================================================
# Use this configuration when:
# - Running on standard Docker without OrbStack
# - CI/CD pipelines
# - Deployment on remote servers (development, staging, production)
# - Using a custom domain name or localhost
#
# Setup:
#   1. Copy this file: cp .env.standard.example .env
#   2. Replace "localhost" with your domain name in NEXTAUTH_URL
#   3. Update Keycloak redirect URIs to match your domain
#   4. Update KEYCLOAK_CLIENT_SECRET with value from Keycloak admin
#   5. Configure SSL certificates for production HTTPS
#   6. Build and start: docker compose up -d --build
#
# Examples:
#   - Development: NEXTAUTH_URL=http://localhost
#   - Staging: NEXTAUTH_URL=https://staging.example.com
#   - Production: NEXTAUTH_URL=https://example.com
# ==============================================================================

# MinIO Configuration
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin123
MINIO_BUCKET_NAME=k-wiki

# PostgreSQL Configuration
POSTGRES_USER=kwiki
POSTGRES_PASSWORD=kwiki123
POSTGRES_APP_DB=k_wiki
POSTGRES_APP_USER=kwiki
POSTGRES_APP_PASSWORD=kwiki123

# Keycloak Configuration
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=admin123
KEYCLOAK_REALM=k-wiki
KEYCLOAK_CLIENT_ID=k-wiki-client
KEYCLOAK_CLIENT_SECRET=your-client-secret-from-keycloak-admin-console

# Keycloak Issuer URL
# IMPORTANT: Use internal Docker container name for server-side calls
# The Next.js app container talks to Keycloak via Docker internal network
KEYCLOAK_ISSUER=http://keycloak:8080/realms/k-wiki

# Keycloak Admin API Configuration (for user management)
# Use internal Docker container name for server-side API calls
KEYCLOAK_ADMIN_URL=http://keycloak:8080

# NextAuth Configuration
# Replace with your domain name for staging/production deployments
# Examples: http://localhost, https://staging.example.com, https://example.com
NEXTAUTH_URL=http://localhost
NEXTAUTH_SECRET=generate-with-openssl-rand-base64-32

# ==============================================================================
# REQUIRED DOCKER-COMPOSE.YML PORT MAPPINGS:
#
# Make sure your docker-compose.yml has these port mappings:
#
# services:
#   nginx:
#     ports:
#       - "80:80"      # Main app access
#       - "443:443"    # HTTPS (optional, needs cert config)
#
#   keycloak:
#     ports:
#       - "8080:8080"  # Keycloak admin console
#
#   minio:
#     ports:
#       - "9001:9001"  # MinIO console
#
#   postgres:
#     ports:
#       - "5432:5432"  # Optional, for direct DB access
# ==============================================================================

# ==============================================================================
# NOTES:
#
# 1. Access Points (for localhost deployment):
#    - App: http://localhost
#    - Keycloak Admin: http://localhost:8080
#    - MinIO Console: http://localhost:9001
#
# 2. For Custom Domain Deployment:
#    - Replace all "localhost" references with your domain
#    - Configure SSL certificates in Nginx for HTTPS
#    - Update Keycloak Valid Redirect URIs: https://yourdomain.com/api/auth/callback/keycloak
#    - Update Keycloak Web Origins: https://yourdomain.com
#
# 3. Keycloak Client Setup:
#    - Go to: http://localhost:8080 (or https://yourdomain.com:8080)
#    - Login with admin/admin123 (or your KEYCLOAK_ADMIN credentials)
#    - Create realm: k-wiki
#    - Create client: k-wiki-client
#      - Client Protocol: openid-connect
#      - Access Type: confidential
#      - Valid Redirect URIs: http://localhost/api/auth/callback/keycloak (or your domain)
#      - Web Origins: http://localhost (or your domain)
#    - Copy Client Secret to KEYCLOAK_CLIENT_SECRET above
#
# 4. Generate NEXTAUTH_SECRET:
#    Run: openssl rand -base64 32
#
# 5. Database URL (auto-configured in docker-compose.yml):
#    DATABASE_URL=postgresql://${POSTGRES_APP_USER}:${POSTGRES_APP_PASSWORD}@postgres:5432/${POSTGRES_APP_DB}
#
# 6. Two-Way Keycloak Access:
#    - Server-side (Next.js → Keycloak): http://keycloak:8080 (internal Docker network)
#    - Browser (User → Keycloak): http://localhost:8080 or https://yourdomain.com:8080 (external)
#
# 7. Why both "keycloak:8080" and "localhost:8080"?
#    - KEYCLOAK_ISSUER uses container name for internal Docker network communication
#    - Browser redirects use external domain/localhost for user access
#    - Keycloak handles both automatically based on request origin
#
# 8. Production Deployment Best Practices:
#    - Use HTTPS with valid SSL certificates (Let's Encrypt, etc.)
#    - Use strong, unique passwords for all services
#    - Restrict unnecessary port exposure for security
#    - Consider using Docker secrets for sensitive credentials
#    - Set up proper backup strategies for PostgreSQL and MinIO data
# ==============================================================================
